<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <canvas id="chart"></canvas>


    <script>

        // function num(){
        //     return new Promise((resolve,rejected)=>{
        //         const rand = Math.random() > 0.5 ? 1:0;


        //     if(rand){
        //         resolve('work')
        //     }else{
        //         rejected(new Error(`失敗了`))
        //     }}//promise後面可以直接接then往後續動作
        //     ).then((work)=>{console.log(work)}//then通常接成功結果，then放兩個參數一個成功、失敗(可以只放其一)
        //     ).catch(failed=>{console.log(failed)}//catch可以接失敗結果(部分都這樣寫)，可以用return來跳到其他的then動作
        //     ).finally(()=>{//finally來結束整個讀取結果
        //         console.log('done')
        //     })
        // }
        // console.log(num());



        // function get(url) {//加上promise寫法

        //     return new Promise((resolve, reject) => {
        //         var req = new XMLHttpRequest();
        //         req.open('GET', url);
        //         req.onload = function () {
        //             if (req.status == 200) {
        //                 resolve(JSON.parse(req.response));
        //             } else {
        //                 reject(new Error('失敗'));
        //             }
        //         }
        //         req.send();
        //     })



        // }
        // get('https://jsonplaceholder.typicode.com/todos/3')
        // .then(res=>{
        //     console.log(res)
        // }).catch(res=>{
        //     console.error(res)
        // })


        // var url = 'input.json'//原始寫法
        // var req = new XMLHttpRequest();
        // req.open('GET',url,true)
        // req.send()
        // req.onload=()=>{
        //     console.log( req.response)

        // }

        // let promise = fetch(url)//fetch寫法
        // .then((response)=>{
        //     // response.json();
        //     return response.arrayBuffer()
        // }).then((response=>{
        //     console.log(response)
        // }))
        // .catch((err)=>{
        //     console.log(err)
        // })


        // async function getIss(){
        //     const response = await fetch('https://api.wheretheiss.at/v1/satellites/25544')
        //     const data =await response.json()
        //     const {latitude,longitude} = data//把要得特定物件變數化
        //     console.log()
        //     document.getElementById('lat').textContent=latitude;
        //     document.getElementById('lon').textContent=longitude;

        // }
        // function getImg(){
        //     fetch('123.JPG')
        //     .then((response)=>{

        //         return response.blob()
        //     }).then((blob)=>{
        //         var img = document.createElement('img')
        //         // img.setAttribute('src')
        //         var blob = URL.createObjectURL(blob)
        //         document.body.appendChild(img)
        //         img.src = blob
        //         console.log(img)


        //     })
        // }
        // getImg()

        //     const url ='https://jsonplaceholder.typicode.com/todos/1'
        // function get(url){
        //     return new Promise((resolve, reject) => {
        //    let req = new XMLHttpRequest()
        //     req.open('GET',url,true);


        //     req.onload=()=>{
        //         var response= req.response;
        //         resolve(response)
        //     }
        //     req.send()
        // })
        // }

        // get(url)      
        // Promise.all([get(url)])
        // .then((data)=>{
        //     console.log(data[0])
        // })
        // function call(num) {
        //     return new Promise((resolve,reject)=>{
        //         if(num){
        //             resolve(`work${num}`)
        //         }else{
        //             reject(`fail${num}`)
        //         }
        //     })

        // }
        // call()
        // .then((res)=>{
        //     console.log(res)
        // })
        const ctx = document.getElementById('chart');
        const xlabels = [];
        const values = [];
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: xlabels,
                datasets: [{
                    label: 'Per Year of argument',
                    data: values,
                    borderWidth: 1
                    , backgroundColor: '#FFB1C1'
                }],

            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
        async function getcsv() {
            var csv = await fetch('ss.csv', {
                'content- type': 'text/csv'
            })
            var text = await csv.text()
            texts = text.split('\r\n').splice(1)

            texts.forEach(elt => {
                const row = elt.split(',')
                const year = row[0];
                const argOfval = row[1];
                const argOfpeo = row[2];
                xlabels.push(year)
                values.push(argOfval)


            });
            console.log(texts)
        }

        getcsv()


    </script>
</body>

</html>